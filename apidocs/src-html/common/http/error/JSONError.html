<!DOCTYPE HTML>
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../javadocstyle.css" title="Style">
</head>
<body>
<main role="main">
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span><a id="line.1">package common.http.error;</a>
<span class="sourceLineNo">002</span><a id="line.2"></a>
<span class="sourceLineNo">003</span><a id="line.3">import usecase.auth.BannedUserException;</a>
<span class="sourceLineNo">004</span><a id="line.4"></a>
<span class="sourceLineNo">005</span><a id="line.5">import java.lang.annotation.ElementType;</a>
<span class="sourceLineNo">006</span><a id="line.6">import java.lang.annotation.Retention;</a>
<span class="sourceLineNo">007</span><a id="line.7">import java.lang.annotation.RetentionPolicy;</a>
<span class="sourceLineNo">008</span><a id="line.8">import java.lang.annotation.Target;</a>
<span class="sourceLineNo">009</span><a id="line.9"></a>
<span class="sourceLineNo">010</span><a id="line.10">/**</a>
<span class="sourceLineNo">011</span><a id="line.11"> * &lt;p&gt;L'annotazione consente di impostare in modo dichiarativo se inviare eventuali errori in formato JSON nel corpo della risposta&lt;/p&gt;</a>
<span class="sourceLineNo">012</span><a id="line.12"> * &lt;p&gt;Affinché funzioni, è necessario che la servlet su cui applicare l'annotazione estenda {@link common.http.interceptor.InterceptableServlet}&lt;/p&gt;</a>
<span class="sourceLineNo">013</span><a id="line.13"> * &lt;p&gt;È possibile applicare l'annotazione ai singoli metodi "doX" implementati (es. doGet). Applicare l'annotazione</a>
<span class="sourceLineNo">014</span><a id="line.14"> * direttamente alla classe equivale ad applicarla su tutti i metodi "doX" implementati.&lt;/p&gt;</a>
<span class="sourceLineNo">015</span><a id="line.15"> * &lt;p&gt;Quando un metodo "doX" annotato con {@link JSONError} lancia una particolare eccezione</a>
<span class="sourceLineNo">016</span><a id="line.16"> * (elencata in basso), si verificano le seguenti azioni: &lt;/p&gt;</a>
<span class="sourceLineNo">017</span><a id="line.17"> * &lt;ul&gt;</a>
<span class="sourceLineNo">018</span><a id="line.18"> *     &lt;li&gt;Viene catturata l'eccezione allo scopo di recuperare i messaggi di errore rilevanti</a>
<span class="sourceLineNo">019</span><a id="line.19"> *     per inserirli nell'attributo di richiesta &lt;pre&gt;errors&lt;/pre&gt;&lt;/li&gt;</a>
<span class="sourceLineNo">020</span><a id="line.20"> *     &lt;li&gt;I messaggi raccolti vengono inclusi in un array JSON con chiave &lt;pre&gt;errors&lt;/pre&gt;&lt;/li&gt;</a>
<span class="sourceLineNo">021</span><a id="line.21"> *     &lt;li&gt;Viene impostato l'apposito status code a seconda dell'eccezione catturata&lt;/li&gt;</a>
<span class="sourceLineNo">022</span><a id="line.22"> *     &lt;li&gt;Il JSON risultante viene scritto sulla risposta&lt;/li&gt;</a>
<span class="sourceLineNo">023</span><a id="line.23"> * &lt;/ul&gt;</a>
<span class="sourceLineNo">024</span><a id="line.24"> * &lt;p&gt;Le eccezioni catturate sono le seguenti:  &lt;/p&gt;</a>
<span class="sourceLineNo">025</span><a id="line.25"> * &lt;table&gt;</a>
<span class="sourceLineNo">026</span><a id="line.26"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">027</span><a id="line.27"> *         &lt;td&gt;Eccezione&lt;/td&gt;&lt;td&gt;Messaggi di errore&lt;/td&gt;&lt;td&gt;Status code&lt;/td&gt;</a>
<span class="sourceLineNo">028</span><a id="line.28"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">029</span><a id="line.29"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">030</span><a id="line.30"> *         &lt;td&gt;{@link javax.validation.ConstraintViolationException}&lt;/td&gt;&lt;td&gt;I messaggi degli oggetti {@link javax.validation.ConstraintViolation}&lt;/td&gt;&lt;td&gt;400&lt;/td&gt;</a>
<span class="sourceLineNo">031</span><a id="line.31"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">032</span><a id="line.32"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">033</span><a id="line.33"> *         &lt;td&gt;{@link IllegalArgumentException}&lt;/td&gt;&lt;td&gt;{@link IllegalArgumentException#getMessage()}&lt;/td&gt;&lt;td&gt;400&lt;/td&gt;</a>
<span class="sourceLineNo">034</span><a id="line.34"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">035</span><a id="line.35"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">036</span><a id="line.36"> *         &lt;td&gt;{@link usecase.auth.AuthenticationRequiredException}&lt;/td&gt;&lt;td&gt;{@link usecase.auth.AuthenticationRequiredException#getMessage()}&lt;/td&gt;&lt;td&gt;401&lt;/td&gt;</a>
<span class="sourceLineNo">037</span><a id="line.37"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">038</span><a id="line.38"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">039</span><a id="line.39"> *         &lt;td&gt;{@link usecase.auth.BannedUserException}&lt;/td&gt;&lt;td&gt;La durata del ban, contenuta in {@link BannedUserException#getDuration()}&lt;/td&gt;&lt;td&gt;403&lt;/td&gt;</a>
<span class="sourceLineNo">040</span><a id="line.40"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">041</span><a id="line.41"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">042</span><a id="line.42"> *         &lt;td&gt;{@link usecase.auth.AuthorizationException}&lt;/td&gt;&lt;td&gt;{@link usecase.auth.AuthorizationException#getMessage()}&lt;/td&gt;&lt;td&gt;403&lt;/td&gt;</a>
<span class="sourceLineNo">043</span><a id="line.43"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">044</span><a id="line.44"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">045</span><a id="line.45"> *         &lt;td&gt;{@link RuntimeException}&lt;/td&gt;&lt;td&gt;{{@link RuntimeException#getMessage()}}&lt;/td&gt;&lt;td&gt;4500&lt;/td&gt;</a>
<span class="sourceLineNo">046</span><a id="line.46"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">047</span><a id="line.47"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">048</span><a id="line.48"> *         &lt;td&gt;{@link javax.servlet.ServletException}&lt;/td&gt;&lt;td&gt;{{@link javax.servlet.ServletException#getMessage()}}&lt;/td&gt;&lt;td&gt;500&lt;/td&gt;</a>
<span class="sourceLineNo">049</span><a id="line.49"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">050</span><a id="line.50"> *     &lt;tr&gt;</a>
<span class="sourceLineNo">051</span><a id="line.51"> *         &lt;td&gt;{@link java.io.IOException}&lt;/td&gt;&lt;td&gt;{{@link java.io.IOException#getMessage()}}&lt;/td&gt;&lt;td&gt;500&lt;/td&gt;</a>
<span class="sourceLineNo">052</span><a id="line.52"> *     &lt;/tr&gt;</a>
<span class="sourceLineNo">053</span><a id="line.53"> * &lt;/table&gt;</a>
<span class="sourceLineNo">054</span><a id="line.54"> * @see ForwardOnErrorInterceptor</a>
<span class="sourceLineNo">055</span><a id="line.55"> * @see common.http.interceptor.InterceptableServlet</a>
<span class="sourceLineNo">056</span><a id="line.56"> * @see common.http.interceptor.ServletInterceptor</a>
<span class="sourceLineNo">057</span><a id="line.57"> */</a>
<span class="sourceLineNo">058</span><a id="line.58">@Target({ElementType.METHOD,ElementType.TYPE})</a>
<span class="sourceLineNo">059</span><a id="line.59">@Retention(RetentionPolicy.RUNTIME)</a>
<span class="sourceLineNo">060</span><a id="line.60">public @interface JSONError {</a>
<span class="sourceLineNo">061</span><a id="line.61">}</a>




























































</pre>
</div>
</main>
</body>
</html>
